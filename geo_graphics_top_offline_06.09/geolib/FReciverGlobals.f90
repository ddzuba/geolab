!****************************************************************************
!  Global data, parameters, and structures 
!****************************************************************************

module FReciverGlobals
use dflogm
implicit none

!  Parameters

integer*4, parameter, public :: SIZEOFAPPNAME = 100

!  Global data

integer		coord ! для приема координаты
REAL*4		kilometr ! для приема километров
REAL*4		metr ! для приема метров
REAL*4		KILOMETR_MOUSE ! для приема километров от мыши
REAL*4		METR_MOUSE ! для приема метров от мыши
integer		kilometr_0 ! для приема километров первой трассы
integer		metr_0	   ! для приема метров первой трассы
integer		kilometr_1 !,kilometr_1 ! для имени файла рисунков
integer		metr_1	   !,metr_2		  ! для имени файла рисунков
integer		metr_old_ ! для приема метров

integer		ghInstance
integer		ghModule
integer		ghwndMain
integer		ghMenu
integer		nfnt	! размер шрифта на экране
integer		nfnt1	! ширина полосы

integer		isFirst /1/
integer		hMainBitmap /0/
integer		hMainDC /0/
integer		hBackBitmap /0/
integer		hBackDC /0/

REAL*4, ALLOCATABLE, target :: MyTrassa(:)	! трасса, длина зависит от числа каналов
REAL*4, ALLOCATABLE, target :: trace_buf(:) ! буфер трассы, длина рисования

! Полоса, в пределах которой рисуется график суммы
integer sum_line_top / 50 /
integer sum_line_bottom / 300 /

integer NSHPAL_OLD / -1 /

! Для палитры, мин. и макс. значения, соответствующте
! белому и чёрному цветам.
real*4	MAX_VAL / 10000  /
real*4	MAX_VAL_OLD / 10000  /
real*4	MIN_VAL / -10000 /

integer NPT / 0 / ! число точек в трассе

integer		img_w /1000/ ! ширина рисунка
integer		img_h /600/ ! высота рисунка
integer		img_hh  ! высота рисунка

integer		speed_gr_zero /240/ ! положение нуля графика скорости
real*4		speed_gr_scale /30.0/ ! масштаб (множитель) графика скорости 
integer		speed_gr_color / 255 /  ! цвет линии графика скорости

integer		sum_gr_zero /598/ ! положение нуля графика огибающей
real*4		sum_gr_scale /0.01/ ! масштаб (множитель) графика огибающей 
integer		sum_gr_color / ZFF0000 / !/ 16711680 /  ! цвет линии графика огибающей

INTEGER*4 , ALLOCATABLE ::trace_draw_pos(:)	   ! положение трассы
INTEGER*4 , ALLOCATABLE ::trace_draw_pos_1(:)  ! тангенс угла наклона
INTEGER*4 , ALLOCATABLE ::trace_draw_pos_2(:)  ! отражательная способность
INTEGER*4 , ALLOCATABLE ::trace_draw_pos_3(:)  ! однородности слоя
INTEGER*4 , ALLOCATABLE ::trace_draw_pos_4(:)  ! момент
INTEGER*4 , ALLOCATABLE ::trace_draw_pos_5(:)  ! положение рисунка

integer		TRACE_POS / 0 / ! текущая позиция трассы при отрисовке.

integer*4, target	:: booboo
integer*4, target	:: cursor_pos = -1 ! положение курсора (места последнего щелчка мыши)
integer*4, target	:: TRACE_COUNT = 0 ! счётчик принятых трасс

CHARACTER(100) configFileName / "geolib.cfg"C /
CHARACTER(500) fullConfigFilePath / ""C /

! Консоль
type(dialog) InfoDialog
integer CONSOLE_LIMIT / 200000 /
character(200000) :: REZTEXT
character(200000) :: CUR_CONSOLE
end module

MODULE PARAM_
USE DFLOGM				! обязательная ссылка в случае DVF
INCLUDE 'RESOURCE.FD'	! включаю параметры ресурсов
LOGICAL(4) FLAG
!----------------------------------------------------------------------------------------------------
INTEGER*4  IANTENNA											! ТИП АНТЕННОГО БЛОКА
INTEGER*4  J_LEVEL											! УРОВЕНЬ ИЗОБРАЖЕНИЯ РАДАРОГРАММЫ В ТОЧКАХ 
INTEGER*4  L_REGION,M_REGION,M2_REGION						! ПАРАМЕТРЫ ВЫБОРА ОКНА УСРЕДНЕНИЯ
REAL*4 POROG_INTENS                                         ! ПОРОГ ПОДАВЛЕНИЯ КАНАЛА
REAL*4 POROG												! КОНСТАНТА ПОДАВЛЕНИЯ БЕЛОГО ШУМА
REAL*4 POROG1												! КОНСТАНТА ПОИСКА МАКСИМУМА
REAL*4 POROG2												! КОНСТАНТА ПОДАВЛЕНИЯ НИЗКИХ ЧАСТОТ
INTEGER*4  LM_WINDOW,N_FINISH,N_START						! РАЗМЕР ОКНА ОБРАБОТКИ И УСРЕДНЕНИЯ
REAL*4  RN_FINISH,RN_START						            ! КОНСТАНТЫ ДЛЯ ВЫЧИСЛЕНИЯ РАЗМЕРА ОКНА ОБРАБОТКИ И УСРЕДНЕНИЯ
INTEGER*4  NDEG1                                            ! ПОРЯДОК ПОЛИНОМА ДЛЯ ИНТЕРПОЛЯЦИИ ГРАНИЦ РАЗДЕЛА
INTEGER*4  KEY_MIDL,KEY_MIDL1/0/                            ! КОНСТАНТА ВЫЧИТАНИЯ ИЗ ТРАССЫ СРЕДНЕЙ ТРАССЫ
INTEGER*4  KEY_REFLECTION                                   ! КОНСТАНТА ПОДАВЛЕНИЯ ЛИНИЙ КРАТНОГО ОТРАЖЕНИЯ

!----------------------------------------------------------------------------------------------------
! ПЕРЕМЕННЫЕ ДИАЛОГОВ -------------------------------------------------------------------------------
TYPE(DIALOG) PARAMETR										!
TYPE(DIALOG) PARAMETR1										!
TYPE(DIALOG) PARAMETR2										!
TYPE(DIALOG) PARAMETR3										!
TYPE(DIALOG) PARAMETR4										!
INTEGER*4  STATUS											!
CHARACTER *200 STRING										!
!----------------------------------------------------------------------------------------------------
! ОБРАБОТКА РЕЗУЛЬТАТОВ РАСЧЕТА ---------------------------------------------------------------------
INTEGER*4  ITEK/0/								! ТЕКУЩИЙ НОМЕР ОБРАБАТЫВАЕМОЙ ТРАССЫ

INTEGER(4), ALLOCATABLE:: IPR_CHEN(:)           ! ПРИЗНАК ПОДАВЛЕНИЯ КАНАЛА
INTEGER(4), ALLOCATABLE:: IPR(:)				! КЛЮЧ ДЛЯ ВЛАЖНОГО УЧАСТКА
INTEGER(4), ALLOCATABLE:: IPR1(:)				! КЛЮЧ ДЛЯ РАСЧЕТА УГЛУБЛЕНИЙ
INTEGER(4), ALLOCATABLE:: IPR1_UP(:)            ! КЛЮЧ ДЛЯ РАСЧЕТА БАЛЛАСТНЫХ УГЛУБЛЕНИЙ

!REAL*4, ALLOCATABLE:: UNIFORMITY(:)							! UNIFORMITY_KR ! ОДНОРОДНОСТЬ
!REAL*4, ALLOCATABLE::UNIFORMITY_MIDL(:)	                    ! UNIFORMITY_KR ! ОДНОРОДНОСТЬ

INTEGER*4  N_MIDL_U							                ! МАССИВ ДЛЯ УСРЕДНЕНИЯ ОДНОРОДНОСТИ


REAL*4, ALLOCATABLE::REFR(:)				                ! ОТРАЖАТЕЛЬНАЯ СПОСОБНОСТЬ
REAL*4, ALLOCATABLE::REFR_MIDL(:)			                ! ОТРАЖАТЕЛЬНАЯ СПОСОБНОСТЬ
REAL*4, ALLOCATABLE::REFR_MAX(:)			                ! МАКСИМАЛЬНАЯ ОТРАЖАТЕЛЬНАЯ СПОСОБНОСТЬ
REAL*4, ALLOCATABLE:: REFRACTION(:,:)                       ! БУФФЕР ОТРАЖАТЕЛЬНЫХ СПОСОБНОСТЕЙ
INTEGER*4,ALLOCATABLE::STAR0(:)                             ! ГРАНИЦЫ ПОЛОС ДЛЯ ПЕЧАТИ ВЛАЖНОСТИ  
INTEGER*4,ALLOCATABLE::FIN0(:)                              ! ГРАНИЦЫ ПОЛОС ДЛЯ ПЕЧАТИ ВЛАЖНОСТИ  
INTEGER*4,ALLOCATABLE::STAR1(:)                             ! ГРАНИЦЫ ПОЛОС ДЛЯ ПЕЧАТИ ВЛАЖНОСТИ  
INTEGER*4,ALLOCATABLE::FIN1(:)                              ! ГРАНИЦЫ ПОЛОС ДЛЯ ПЕЧАТИ ВЛАЖНОСТИ  
INTEGER*4,ALLOCATABLE::STAR1_OLD(:)                         ! ГРАНИЦЫ ПОЛОС ДЛЯ ПЕЧАТИ ВЛАЖНОСТИ  
INTEGER*4,ALLOCATABLE::KL_FORPRINT(:)                       ! КЛЮЧ ДЛЯ ПЕЧАТИ ВЛАЖНОСТИ (0 И ДЛИНА МАССИВА FORPRINT)
INTEGER*4,ALLOCATABLE::FLAG_FORPRINT(:)                     ! ФЛАГ ПРОСТО ПЕЧАТИ ВЛАЖНОСТИ
INTEGER*4 DL_BLUE,DL_WIGHT                                  ! ДЛИНЫ ВЛАЖНЫХ И СУХИХ УЧАСТКОВ В ТРАССАХ
REAL*4, ALLOCATABLE::RMOM(:)								! RMOM_KR ! МОМЕНТ
REAL*4, ALLOCATABLE::RMOM_MIDL(:)			                ! RMOM_KR ! МОМЕНТ
REAL*4, ALLOCATABLE::RMOM_MAX(:)			                ! МАКСИМАЛЬНАЯ ОТРАЖАТЕЛЬНАЯ СПОСОБНОСТЬ
			
REAL*4, ALLOCATABLE::R_BALL(:)			                    ! ГЛУБИНА  ДНА										
REAL*4, ALLOCATABLE::R_BALL_UP(:)                           ! ГЛУБИНА БАЛЛАСТНОГО ДНА										
REAL*4, ALLOCATABLE::R_BALL_MIDL(:)		                    ! ГЛУБИНА  ДНА										
REAL*4, ALLOCATABLE::R_BALL_MIDL_UP(:)		                ! ГЛУБИНА БАЛЛАСТНОГО ДНА										
INTEGER*4  N_MIDL_BALL						                ! МАССИВ ДЛЯ УСРЕДНЕНИЯ ГЛУБИНЫ БАЛЛАСТНОГО ДНА
! INTEGER*4  N_MIDL_BALL_UP                                 ! МАССИВ ДЛЯ УСРЕДНЕНИЯ ГЛУБИНЫ БАЛЛАСТНОГО ДНА
REAL*4,ALLOCATABLE :: BALL(:,:)
REAL*4,ALLOCATABLE :: BALL_UP(:,:)
REAL*4 RABTIME
!-------------------------------------------------------------------------------------------------
REAL*4, ALLOCATABLE :: SUM_RAB_MIDL(:,:)					! РАБОЧИЙ МАССИВ ДЛЯ УСРЕДНЕНИЯ
REAL*4, ALLOCATABLE :: SUM_MIDDLE(:,:)  					! РАБОЧИЙ МАССИВ ДЛЯ ВЫЧИТАНИЯ
REAL*4, ALLOCATABLE :: HH(:)					            ! МАССИВ ГЛУБИН
REAL*4, ALLOCATABLE :: T_N(:)					            ! МАССИВ ВРЕМЕН
INTEGER*4, ALLOCATABLE :: IHH_50(:)					        ! МАССИВ НОМЕРОВ ТОЧЕК С ШАГОМ 50 СМ
INTEGER*4 HH_RAB                                            ! ШАГ ДЛЯ ИЗОБРАЖЕНИЯ ШКАЛЫ ГЛУБИН В ДОЛЯХ ОТ HH_STEP
REAL*4 HH_STEP                                              ! ШАГ ДЛЯ ИЗОБРАЖЕНИЯ ЧИСЕЛ НА ШКАЛЕ ГЛУБИН В МЕТРАХ
INTEGER*4 FLAG_HH                                           ! КЛЮЧ ДЛЯ ИЗОБРАЖЕНИЯ СЕТКИ ШКАЛЫ ГЛУБИН
INTEGER*4 FLAG_WINDOW                                       ! КЛЮЧ ДЛЯ ИЗОБРАЖЕНИЯ ОКНА
INTEGER*4 I_HH                                              ! ЧИСЛО ТОЧЕК В МАССИВЕ НОМЕРОВ ТОЧЕК С ШАГОМ 50 СМ 
REAL*4 T_RAZV												! РАЗВЕРТКА
REAL*4 VC0 /30/                                             ! СКОРОСТЬ СВЕТА В СМ/НС
INTEGER*4 JJ_H	    				                        ! ТОЧКА НАЧАЛА СИГНАЛА ОТ ПОВЕРХНОСТИ		
REAL*4 HH_B	   											    ! ВЫСОТА ПОДВЕСА АНТЕННЫ 
REAL*4 BAZ                                                  ! РАССТОЯНИЕ МЕЖДУ АНТЕННАМИ
REAL*4, ALLOCATABLE :: BUFF(:,:,:)							! НАКОПЛЕНИЕ ТРАСС ДЛЯ УСРЕДНЕНИЯ
REAL*4, ALLOCATABLE :: BUFF_MIDDLE(:,:,:)                   ! НАКОПЛЕНИЕ ТРАСС ДЛЯ ВЫЧИТАНИЯ СРЕДНЕГО
! ФАЙЛОВАЯ ИНФОРМАЦИЯ ----------------------------------------------------------------------------				    
CHARACTER(200) DISK,PAPKA,PAPKA1,FILE					    ! ПУТЬ К ФАЙЛУ ЗАПИСИ РИСУНКОВ 
CHARACTER(200),ALLOCATABLE :: FILE_NUMBER(:)                ! МАССИВ ДЛЯ ХРАНЕНИЯ ИМЕН
CHARACTER(200) DISK_TEXT,PAPKA_TEXT,FILE_TEXT			    ! ПУТЬ К ФАЙЛУ ЗАПИСИ ПОЛОЖЕНИЯ МЫШИ
CHARACTER(200) NAME_FILE                				    ! ИМЯ ФАЙЛОВ
CHARACTER(200) NAME_FILE_TEXT			        		    ! ИМЯ ФАЙЛА МЫШИ
INTEGER*4  I_LENTH
CHARACTER STR(200)										    ! ДЛЯ ФОРМИРОВАНИЯ ИМЕНИ
!-------------------------------------------------------------------------------------------------
INTEGER*4  N_FILE_DISK      								! НОМЕР ФАЙЛА B СЧЕТЧИК
REAL*4 PREL											        ! ПОКАЗАТЕЛЬ ПРЕЛОМЛЕНИЯ БАЛЛАСТА
INTEGER*4  J_DOWN										    ! НОМЕР ТРАССЫ ДЛЯ ДНА ШПАЛЫ
!-----------------------------------------------------------------------------------------------------------------------										    
! НОРМИРОВКА ПОКАЗАНИЙ
REAL*4 R_POSIB,R_POSIB1								    ! КОРРЕКТИРУЮЩИЙ МНОЖИТЕЛЬ ДЛЯ ОПРЕДЕЛЕНИЯ МОЩНОСТИ СЛОЯ
REAL*4 R_MOMENT,R_MOMENT1								    ! КОРРЕКТИРУЮЩИЙ МНОЖИТЕЛЬ ДЛЯ ОПРЕДЕЛЕНИЯ МОЩНОСТИ СЛОЯ
REAL*4 R_BALLAST										    ! КОРРЕКТИРУЮЩИЙ МНОЖИТЕЛЬ ДЛЯ ОПРЕДЕЛЕНИЯ БАЛЛАСТНЫХ УГЛУБЛЕНИЙ
!-----------------------------------------------------------------------------------------------------------------------										    
! КОНСТАНТЫ ДЛЯ ВЫВОДА НА ПЕЧАТЬ НОМЕРОВ ПИКЕТОВ------------------------------------------------------------------------ 
INTEGER*4  NFONT											! РАЗМЕР БУКВ ДЛЯ ПОДПИСИ КИЛОМЕТРОВ
INTEGER*4  JSDVIG											! СДВИГ НАДПИСИ ВДОЛЬ ГОРИЗОНТАЛЬНОЙ ОСИ
INTEGER*4  JSDVIG_TR										! СДВИГ НАДПИСИ ВДОЛЬ ГОРИЗОНТАЛЬНОЙ ОСИ
!----------------------------------------------------------------------------------------------------------------------
REAL*4 PARAM_MIDL1                                          ! ПАРАМЕТР ДЛЯ ОПРЕДЕЛЕНИЯ ВЕРХНЕЙ ГРАНИЦЫ ПОЛОСЫ ПРИ АНАЛИЗЕ
REAL*4 PARAM_MIDL2                                          ! ПАРАМЕТР ДЛЯ ОПРЕДЕЛЕНИЯ НИЖНЕЙ ГРАНИЦЫ ПОЛОСЫ ПРИ АНАЛИЗЕ
!----------------------------------------------------------------------------------------------------------------------
END MODULE PARAM_
!-----------------------------------------------------------------------------------------------------------------------
MODULE PARAM_1
! УПРАВЛЕНИЕ КАНАЛАМИ -------------------------------------------------
INTEGER*4 	ISCH/0/		  ! СЧЕТЧИК КАНАЛОВ
INTEGER*4, target :: N_CHEN	= -1      ! ЧИСЛО КАНАЛОВ. -1 - показывает, что переменная не установлена.
INTEGER*4 	N_CHEN_F	      ! НОМЕР ПЕРВОГО КАНАЛА В ПОСЫЛКЕ ИНТЕГРАЛА
INTEGER*4 	N_CHEN_TEK    ! НОМЕР ВЫБРАННОГО КАНАЛА
REAL*4      COORDINATE,COORDINATE1          ! ДЛЯ ВЫЧИСЛЕНИЯ ПРОПУСКА КООРДИНАТ
! ФОРМИРОВАНИЕ ИМЕНИ ПАПКИ---------------------------------------------
! НОМЕР УСТРОЙСТВА
INTEGER*4  N2_DEV,N2_DEV1
CHARACTER *200 N_DEVICE,N_DEVICE1			! номер устройства
! НОМЕР НАПРАВЛЕНИЯ
INTEGER*4  N2_VAY,N2_VAY1
CHARACTER *200 N_VAY,N_VAY1					! номер дороги
! НОМЕР НАПРАВЛЕНИЯ
INTEGER*4  N2_DIR,N2_DIR1
CHARACTER *200 N_DIRECTION,N_DIRECTION1		! код направления
! НОМЕР ПУТИ
INTEGER*4  N2_TRA,N2_TRA1
CHARACTER *200 N_TRACK,N_TRACK1				! номер пути
! НОМЕР ПУТИ
CHARACTER *200 STRING_CHEN					! номер канала
! ИМЯ ПАПКИ
CHARACTER *300 NAME_FILE_IMG,NAME_FILE_IMG_JPEG				! ПАПКА ДЛЯ РАДАРОГРАMM
CHARACTER *300 NAME_FILE_GEO,NAME_FILE_GEO_ZIP				! ПАПКА ДЛЯ КАСКАДА
!INTEGER*4  FLAG_NAME_IMG/0/
!INTEGER*4  FLAG_NAME_GEO/0/
!-----------------------------------------------------------------------
! КОНСТАНТЫ ДЛЯ ЗАДАНИЯ ШАГА ВЫДАЧИ РАДАРОГРАММЫ НА ЭКРАН----------------------------
INTEGER*4, target :: N_PRINT		  ! ШАГ ВЫДАЧИ ТРАСС НА ОБРАБОТКУ И МОНИТОР
!INTEGER*4  LM_WINDOW_N_PRINT		  ! ПРОИЗВЕДЕНИЕ КОНСТАНТ
INTEGER*4  LM_WINDOW1,LM_WINDOW2      ! РАБОЧИЕ КОНСТАНТЫ
INTEGER*4  K_PRINT/1/	  ! ТЕКУЩЕЕ ЗНАЧЕНИЕ ШАГА ВЫДАЧИ РАДАРОГРАММЫ НА ЭКРАН
! ПРИ СОВПАДЕНИЕЕ N_PRINT И K_PRINT ВЫПОЛНЯЕТСЯ ПЕЧАТЬ
INTEGER*4  NP_PRINT/1/		  ! ЧИСЛО ТРАСС ПРИ ЗАПИСИ В ТЕКСТОВЫЙ ФАЙЛ
INTEGER*4  KP_PRINT/1/	  ! ТЕКУЩЕЕ ЗНАЧЕНИЕ ШАГА ВЫДАЧИ В ТЕКСТОВЫЙ ФАЙЛ
! ПРИ СОВПАДЕНИЕЕ NP_PRINT И KP_PRINT ВЫПОЛНЯЕТСЯ ВЫДАЧА В ТЕКСТОВЫЙ ФАЙЛ
!INTEGER*4  N_PRINT5       ! РАБОЧАЯ КОНСТАНТА
!------------------------------------------------------------------------------------
INTEGER*4  IFLAG_PRINT				  ! ПРИЗНАК ПЕЧАТИ
!----------------------------------------------------------------------------------------------------------------------
INTEGER*4  kluch/0/											! ключ для опроса экрана
!----------------------------------------------------------------------------------------------------------------------
INTEGER*4  K_FLAG/0/			! ДЛЯ ФОРМИРОВАНИЯ ПАПОК ВРУЧНУЮ
INTEGER*4  FL_START/0/			! УКАЗАТЕЛЬ НАЧАЛА РАБОТЫ
!----------------------------------------------------------------------------------------------------------------------
!формируем пропуск трасс на рисунке
!----------------------------------------------------------------------------------------------------------------------
REAL*4 rang,rang1				! пройденный путь
REAL*4 rang2					! пройденный путь в килметрах
REAL*4 rang3					! пройденный путь в метрах
integer*4 out_trassa			! число пропущенных трасс
!----------------------------------------------------------------------------------------------------------------------
INTEGER*4 , ALLOCATABLE :: N_WRITE_VLAG(:)	! ЧИСЛО ЗАПИСЕЙ В ФАЙЛ VLAG
INTEGER*4 , ALLOCATABLE :: N_WRITE_UGLUB(:)	! ЧИСЛО ЗАПИСЕЙ В ФАЙЛ UGLUB
INTEGER*4 , ALLOCATABLE :: N_WRITE_TOLSH(:)	! ЧИСЛО ЗАПИСЕЙ В ФАЙЛ TOLSH
!----------------------------------------------------------------------------------------------------------------------
REAL*4 LENGTH_HUMIDITY                      ! МИНИМАЛЬНАЯ ДЛИНА ОБЛАСТЕЙ ВЛАЖНОСТИ
REAL*4 STEP_HUMIDITY                        ! РАССТОЯНИЕ ОБЪЕДИНЕНИЯ ОБЛАСТЕЙ ВЛАЖНОСТИ
!----------------------------------------------------------------------------------------------------------------------

END MODULE PARAM_1
!----------------------------------------------------------------------------------------------------------------------
!----------------------------------------------------------------------------------------------------------------------
MODULE N_									! ИСПОЛЬЗУЕТСЯ ДЛЯ ПЕРЕДАЧИ ИНФОРМАЦИИ
INTEGER*4, target :: N                      ! ДЛИНА ТРАССЫ
INTEGER*4 NN_CHEN,NN_CHEN_F                 ! ДЛИНА ТРАССЫ, УМНОЖЕННАЯ НА ЧИСЛО КАНАЛОВ

REAL*4, ALLOCATABLE :: RDM(:)				! РАБОЧИЙ МАССИВ
REAL*4, ALLOCATABLE :: RDM1(:)			    ! РАБОЧИЙ МАССИВ
REAL*4, ALLOCATABLE :: RDM2(:,:)            ! РАБОЧИЙ МАССИВ
INTEGER*4  IDELTA,IDELTA2,IDELTA4			! ЧИСЛО ТОЧЕК ТРАССЫ НА МЕТР
REAL*4 R_LEV								! ГЛУБИНА СЛОЯ
INTEGER*4  JJ1_B_0							! ВЕРХНЕЕ ЗНАЧЕНИЕ  ОКНА ПОИСКА ГРАНИЦЫ БАЛЛАСТНОГО СЛОЯ 
INTEGER*4  JJ2_B_0							! НИЖНЕЕ ЗНАЧЕНИЕ  ОКНА ПОИСКА ГРАНИЦЫ БАЛЛАСТНОГО СЛОЯ 
INTEGER*4  JJ1_PB_0							! ВЕРХНЕЕ ЗНАЧЕНИЕ  ОКНА ПОИСКА ГРАНИЦЫ ПОДБАЛЛАСТНОГО СЛОЯ 
INTEGER*4  JJ2_PB_0							! НИЖНЕЕ ЗНАЧЕНИЕ  ОКНА ПОИСКА ГРАНИЦЫ ПОДБАЛЛАСТНОГО СЛОЯ 
INTEGER*4  JJ2_GR			                ! НИЖНЕЕ ЗНАЧЕНИЕ ЗЕМЛЯНОГО ПОЛОТНА
INTEGER*4  I_B								! ГРАНИЦА БАЛЛАСТА
INTEGER*4  I_BSEK,I_PBSEK                   ! ГРАНИЦА БАЛЛАСТА
INTEGER*4  I_PB								! ГРАНИЦА ПОДБАЛЛАСТНОГО ОСНОВАНИЯ
INTEGER*4 , ALLOCATABLE:: YY(:,:)			! ЗНАЧЕНИЯ ГРАНИЦЫ БАЛЛАСТА ДЛЯ ИНТЕРПОЛЯЦИЙ
INTEGER*4 , ALLOCATABLE:: YY1(:,:)			! ЗНАЧЕНИЯ  ПОДБАЛЛАСТНОЙ ГРАНИЦЫ ДЛЯ ИНТЕРОЛЯЦИЙ
INTEGER*4 , ALLOCATABLE:: IA(:)				! СЧЕТЧИК ЗАПОЛНЕНИЯ МАССИВОВ ГРАНИЦ
REAL*4 RMULTIPLE                            ! ВЕЛИЧИНА УСИЛЕНИЯ В ПОДБАЛЛАСТНОМ СЛОЕ
REAL*4 R_I_B                                ! ПОСТОЯННА ВЫБОРА УСЛОВНОЙ ВЕРХНЕЙ ЛИНИИ БАЛЛАСТА
REAL*4 R_I_B1                               ! ПОСТОЯННА ВЫБОРА УСЛОВНОЙ НИЖНЕЙ ЛИНИИ БАЛЛАСТА
REAL*4 R_I_PB                               ! ПОСТОЯННА ВЫБОРА УСЛОВНОЙ ЛИНИИ ПОДБАЛЛАСТНОГО ОСНОВАНИЯ

END MODULE N_
!----------------------------------------------------------------------------------------------------------------------
!----------------------------------------------------------------------------------------------------------------------
MODULE DOSTUP_									! ИСПОЛЬЗУЕТСЯ ДЛЯ ОПРЕДЕЛЕНИЯ ПРАВА ДОСТУПА
USE DFLOGM				! обязательная ссылка в случае DVF
INCLUDE 'RESOURCE.FD'	! включаю параметры ресурсов
INTEGER*4 , DIMENSION(1:8) :: SEED				! МАССИВЫ ДЛЯ ГЕНЕРАЦИИ
REAL(8), DIMENSION(1:10000) :: ARRAY			! СЛУЧАЙНЫХ ЧИСЕЛ
INTEGER(2), DIMENSION(1:10000) :: KEY_DOPUSK	! МАССИВ ДЛЯ ХРАНЕНИЯ 
INTEGER*4  I,J
INTEGER*4  K									! НОМЕР ЯЧЕЙКИ
INTEGER*4  KL									! Счетчик обращений

CHARACTER *200 TEXT								! ПЕРЕМЕННЫЕ ДЛЯ 
TYPE(DIALOG) PARAMETR_INFO						! ФОРМИРОВАНИЯ
INTEGER*4  STATUS								! СООБЩЕНИЯ

END MODULE DOSTUP_
!----------------------------------------------------------------------------------------------------------------------
!----------------------------------------------------------------------------------------------------------------------
MODULE RAILWAY								! ИСПОЛЬЗУЕТСЯ ДЛЯ ПЕЧАТИ
CHARACTER(250) GRAF,NAME_GRAF			    ! ФАЙЛ ГЛУБИН И ПУТЬ ЗАПИСИ
CHARACTER(250) VLAG,NAME_VLAG				! ФАЙЛ ВЛАЖНОСТИ И ПУТЬ ЗАПИСИ
CHARACTER(250) UGLUB,NAME_UGLUB				! ФАЙЛ БАЛЛАСТНЫХ УГЛУБЛЕНИЙ И ПУТЬ ЗАПИСИ
CHARACTER(250) TOLSH,NAME_TOLSH				! ФАЙЛ БАЛЛАСТНЫХ УГЛУБЛЕНИЙ И ПУТЬ ЗАПИСИ
CHARACTER(250) INFO,NAME_INFO				! ФАЙЛ СЛУЖЕБНЫЙ
CHARACTER(250), ALLOCATABLE ::  GRAF_NUMBER(:)	!МАССИВ ДЛЯ ХРАНЕНИЯ ИМЕН
CHARACTER(250), ALLOCATABLE ::  VLAG_NUMBER(:)	!МАССИВ ДЛЯ ХРАНЕНИЯ ИМЕН
CHARACTER(250), ALLOCATABLE ::  UGLUB_NUMBER(:)	!МАССИВ ДЛЯ ХРАНЕНИЯ ИМЕН
CHARACTER(250), ALLOCATABLE ::  TOLSH_NUMBER(:)	!МАССИВ ДЛЯ ХРАНЕНИЯ ИМЕН
! CHARACTER(1) STRKA
CHARACTER(200) S1,S2,S3,S4,S5,S6				! РАБОЧИЕ ЯЧЕЙКИ ДЛЯ ВЫВОДА В ФАЙЛ .CSV
CHARACTER(200) S1_G,S2_G,S3_G,S4_G,S5_G		! РАБОЧИЕ ЯЧЕЙКИ ДЛЯ ВЫВОДА В ФАЙЛ .CSV
CHARACTER(200), ALLOCATABLE :: S1_V(:),S2_V(:),S3_V(:),S4_V(:),S5_V(:),S6_V(:)		! РАБОЧИЕ ЯЧЕЙКИ ДЛЯ ВЫВОДА В ФАЙЛ .CSV
CHARACTER(200), ALLOCATABLE :: S1_U(:),S2_U(:),S3_U(:),S4_U(:),S5_U(:)		! РАБОЧИЕ ЯЧЕЙКИ ДЛЯ ВЫВОДА В ФАЙЛ .CSV
CHARACTER(200), ALLOCATABLE :: S1_U_UP(:),S2_U_UP(:),S3_U_UP(:),S4_U_UP(:),S5_U_UP(:)		! РАБОЧИЕ ЯЧЕЙКИ ДЛЯ ВЫВОДА В ФАЙЛ .CSV
CHARACTER(200) STRING_200					! РАБОЧАЯ ЯЧЕЙКА
INTEGER*4 , ALLOCATABLE::ii_bal(:)				! ТОЧКИ ГРАНИЦ БАЛЛАСТА И ОСНОВАНИЯ
INTEGER*4 , ALLOCATABLE::ii_osn(:)				! ТОЧКИ ГРАНИЦ БАЛЛАСТА И ОСНОВАНИЯ
CHARACTER (8) DDATA
CHARACTER (10) DDATA1
CHARACTER (4) YER				! год
CHARACTER (2) MAUNS				! месяц
CHARACTER (2) DAY				! день
CHARACTER (2) HAUR				! час
CHARACTER (2) MINIT				! минута
CHARACTER (2) SEK			    ! сукунда
       integer(2)  wYear 
       integer(2)  wMonth 
       integer(2)  wDayOfWeek 
       integer(2)  wDay 
       integer(2)  wHour 
       integer(2)  wMinute 
       integer(2)  wSecond 
       integer(2)  wMilliseconds 
REAL(8) , ALLOCATABLE::VREMYA_MOUSE(:)              ! ВРЕМЯ ДЛЯ ТРАСС НА ЭКРАНЕ
REAL(8) SEKK0 /0/                                   ! НАЧАЛЬНОЕ ВРЕМЯ
REAL(8) SEKK  /0/                                   ! ТЕКУЩЕЕ ВРЕМЯ
REAL(4) TIME_VIDEO_FILE                             ! ВРЕМЯ ОБРАЗОВАНИЯ ВИДЕО ФАЙЛА
CHARACTER*100 VIDEO_NAME/'ZERO'/                    ! ИМЯ ФАЙЛА С ВИДЕОИНФОРМАЦИЕЙ
CHARACTER*100 FOTO_NAME/'ZERO'/                     ! ИМЯ ФАЙЛА С ВИДЕОИНФОРМАЦИЕЙ
CHARACTER(200), ALLOCATABLE :: STRING_GRAF_CSV(:)	! ИНФОРМАЦИЯ ДЛЯ НАКОПЛЕНИЯ ГЛУБИН 
INTEGER*4  n_GRAF/0/								! РАЗМЕРНОСТЬ БУФЕРА
INTEGER*4  i_GRAF/0/								! СЧЕТЧИК ЗАПОЛНЕНИЯ ТЕКСТОВОГО БУФЕРА ГЛУБИН

CHARACTER(200), ALLOCATABLE :: STRING_VLAG_CSV(:,:)	! ИНФОРМАЦИЯ ДЛЯ НАКОПЛЕНИЯ ОБЛАСТЕЙ ВЛАЖНОСТИ
INTEGER*4  n_VLAG/0/								! РАЗМЕРНОСТЬ БУФЕРА

CHARACTER(200), ALLOCATABLE :: STRING_UGLUB_CSV(:,:)	! ИНФОРМАЦИЯ ДЛЯ НАКОПЛЕНИЯ ОБЛАСТЕЙ ПРОСАДОК
INTEGER*4  n_UGLUB/0/								    ! РАЗМЕРНОСТЬ БУФЕРА

CHARACTER(200), ALLOCATABLE :: STRING_TOLSH_CSV(:,:)	! ИНФОРМАЦИЯ ДЛЯ НАКОПЛЕНИЯ ОБЛАСТЕЙ ПРОСАДОК
INTEGER*4  n_TOLSH/0/								    ! РАЗМЕРНОСТЬ БУФЕРА
!----------------------------------------------------------------------------------------------------------------------
INTEGER*4  N_BIT											    ! ЧИСЛО БИТ ПЕРЕДАЧИ ДАННЫХ
!----------------------------------------------------------------------------------------------------------------------
INTEGER*4  IFL_WRITER/1/										! КЛЮЧ ЗАПИСИ НА ДИСК ИЗОБРАЖЕНИЙ
INTEGER*4  IFL_WRITER_TEXT/1/									! КЛЮЧ ЗАПИСИ ПОЛОЖЕНИЯ МЫШИ НА ЭКРАНЕ
INTEGER*4  IFL_WRITER_KASKAD/1/								    ! КЛЮЧ ЗАПИСИ НА ДИСК ТЕКСТОВ

END MODULE RAILWAY

MODULE GRAFICA
INTEGER*4  N_PRIZNAK_GRAFICA/0/		! ПРИЗНАК ВЫВОДА НА ЭКРАН
INTEGER*4  M_OUT/4/					! ЧИСЛО ОТОБРАЖАЕМЫХ ФИЗИЧЕСКИХ ПАРАМЕТРОВ
CHARACTER(200) TEXT_2/" Влажность"/
CHARACTER(200) TEXT_4/" Деформативность"/
INTEGER*4 ISTEP_FOR_GRAFICA
REAL*4 ISTEP_BETWEEN_TRASES
END MODULE GRAFICA
    
MODULE VLAG_CSV
REAL(4),ALLOCATABLE ::KILOMETR_FIRST(:)
REAL(4),ALLOCATABLE ::METR_FIRST(:)
REAL(4) IDL
REAL(4) KILOMETR_SEKOND,METR_SEKOND,IDL_SEKOND	! КИЛОМЕТР И МЕТР КОНЦА ПРЕДЫДУЩЕЙ ЗАПИСИ И ЕЕ ДЛИНА
REAL(4)	KILOMETR_OLD		
REAL(4)	METR_OLD		
REAL(4)	KILOMETR_FIRST_OLD		
REAL(4)	METR_FIRST_OLD
REAL(4)	IDL_OLD
END MODULE VLAG_CSV
    
MODULE UGLUB_CSV
REAL(4),ALLOCATABLE ::KILOMETR_FIRST_U(:)
REAL(4),ALLOCATABLE ::METR_FIRST_U(:)
REAL(4) IDL
REAL(4) KILOMETR_SEKOND,METR_SEKOND,IDL_SEKOND	! КИЛОМЕТР И МЕТР КОНЦА ПРЕДЫДУЩЕЙ ЗАПИСИ И ЕЕ ДЛИНА
REAL(4)	KILOMETR_OLD		
REAL(4)	METR_OLD		
REAL(4)	KILOMETR_FIRST_OLD		
REAL(4)	METR_FIRST_OLD
REAL(4)	IDL_OLD
END MODULE UGLUB_CSV

MODULE TOLSH_CSV
REAL(4),ALLOCATABLE ::KILOMETR_FIRST_T(:)
REAL(4),ALLOCATABLE ::METR_FIRST_T(:)
REAL(4) IDL
REAL(4) KILOMETR_SEKOND,METR_SEKOND,IDL_SEKOND	! КИЛОМЕТР И МЕТР КОНЦА ПРЕДЫДУЩЕЙ ЗАПИСИ И ЕЕ ДЛИНА
REAL(4)	KILOMETR_OLD		
REAL(4)	METR_OLD		
REAL(4)	KILOMETR_FIRST_OLD		
REAL(4)	METR_FIRST_OLD
REAL(4)	IDL_OLD
END MODULE TOLSH_CSV
